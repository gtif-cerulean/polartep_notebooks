{"version":3,"kind":"Notebook","sha256":"6c6d6627a9603d6b18b26293b8b50fdec3798f1f6d4a16886c4b2a41083b4f8b","slug":"notebooks.xcube-tutorial","location":"/notebooks/xcube_tutorial.ipynb","dependencies":[],"frontmatter":{"title":"PolarTEP eScience Lab:  Using XCube in Polar-TEP to Generate NDVI","content_includes_title":false,"kernelspec":{"name":"conda-env-users-edc-2022.10-14-py","display_name":"users-edc-2022.10-14","language":"python"},"github":"https://github.com/gtif-cerulean/polartep_notebooks","subject":"Notebook examples","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gtif-cerulean/polartep_notebooks/blob/main/notebooks/xcube_tutorial.ipynb","edit_url":"https://github.com/gtif-cerulean/polartep_notebooks/edit/main/notebooks/xcube_tutorial.ipynb","exports":[{"format":"ipynb","filename":"xcube_tutorial.ipynb","url":"/polartep_notebooks/build/xcube_tutorial-c7ab94116ecd25bc61dbb8a03cfd20ee.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"image":"https://raw.githubusercontent.com/gtif-cerulean/polartep_notebooks/refs/heads/main/notebooks/assets/ndvi.png"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xLEX4W1b1h"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"XOJLTZ0TUa"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook uses the xcube function to call imagery into a cube, with the axis being lat, lon, and time. Each point within the cube has whatever bands you call into it. It has its pros and cons, as it certainly cannot do as much as the API but it is significantly easier to use and understand.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lWIINsd93C"}],"key":"G4vWfxMnFw"}],"key":"YaRqNEENC2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ynZCNjWOat"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"KiaoCj16V7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"By the end of the lab exercise, you should be able to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oKcdCxvYc4"}],"key":"LdC69N5kIW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Import supporting code packages into your project","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZIupCaOQE8"}],"key":"e1zEOm43xF"}],"key":"Q7tGUiANzX"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Access PolarTEP data for analysis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MkdmL9VZ8X"}],"key":"W6Lr8c2TD2"}],"key":"lh4upLmmLl"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a multivariable data cube","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eLeMFtrUTt"}],"key":"lE5tSeaosT"}],"key":"vZZi3wG7Th"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize data","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oLZX6NuvBy"}],"key":"J7nFL42nUb"}],"key":"C0IByUAcWy"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Analyze data and generate new data (Normalized Difference Vegetation Index - NDVI)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"umn0TiaoGj"}],"key":"s0UctwjnkW"}],"key":"YglyF4jLIa"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Creating ancillary data visualizations","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Yn1PM2TDP2"}],"key":"l9PHzmWSvn"}],"key":"rYQtbcBEm7"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Exporting data for use on other platforms","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"goI4hWS45C"}],"key":"kOqZIRQZIJ"}],"key":"mWmJztMiEn"}],"key":"OidhCJ21f2"}],"key":"OlFWEEBMdr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Required skills and prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gd9JZSha7i"}],"identifier":"required-skills-and-prerequisites","label":"Required skills and prerequisites","html_id":"required-skills-and-prerequisites","implicit":true,"key":"nmKWNItItC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To complete this tutorial you should have the following skills and tools:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z9uPk09Ofz"}],"key":"pf20qyjrP3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The latest version of a modern browser (e.g. Google Chrome, Mozilla Firefox, Microsoft Edge)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LwhXrlehYY"}],"key":"tuIeJRXbsh"}],"key":"HHrL29m0aH"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A current PolarTEP account","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eZkIdguq7R"}],"key":"kpByYW96DK"}],"key":"NqIK6xH5nj"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Basic understanding of Python code","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E3NVFnYVtf"}],"key":"J9Ux9HrIRv"}],"key":"NRalKk3wf5"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ability to use a Jupyter Notebook, including running code blocks","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DPsbYYaypg"}],"key":"CpwomgS6Jl"}],"key":"KlJ8mObpfU"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Completion of introductory PolarTEP tutorials (INSERT HERE)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"w2pQgSamuq"}],"key":"dAMgvLdXNF"}],"key":"nUceaUmFrx"}],"key":"IK2ATO7tpl"}],"key":"vQZszZSG6m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"External References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xioaTOuNRy"}],"identifier":"external-references","label":"External References","html_id":"external-references","implicit":true,"key":"he3wZB0RW3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://www.python.org/about/gettingstarted/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Python for Beginners","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KkD0VF0jkt"}],"urlSource":"https://www.python.org/about/gettingstarted/","key":"BbjBIMFOkd"}],"key":"W8O0XTyg4s"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://docs.jupyter.org/en/latest/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Jupyter Notebook documentation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hAWQOs1tqN"}],"urlSource":"https://docs.jupyter.org/en/latest/","key":"lypuK1CgPi"}],"key":"cBtxHUn9GU"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Normalized Difference Vegetation Index","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hG7RtJbTbS"}],"urlSource":"https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index","data":{"page":"Normalized_difference_vegetation_index","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"f4pFNAwioP"}],"key":"Fpr3hSpjf9"}],"key":"Xj1J4hoUcC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Importing supporting code packages into your project","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LJSUbbZXM8"}],"identifier":"importing-supporting-code-packages-into-your-project","label":"Importing supporting code packages into your project","html_id":"importing-supporting-code-packages-into-your-project","implicit":true,"key":"QEzzzk9JXG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Most projects will benefit from the use of existing code libraries or “packages” that add functionality to your application.  In this case, you will be creating a data cube, using data arrays, and other data manipulation and analysis utilties.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n9E6zBOfjj"}],"key":"bkzZiQdBu8"}],"key":"xhAUbllujB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2022.10-14\", dependencies=[\"SH\"])\n\n#Packages \n\n# xcube_sh imports\nfrom xcube_sh.cube import open_cube\nfrom xcube_sh.config import CubeConfig\nfrom xcube_sh.observers import Observers\nfrom xcube_sh.viewer import ViewerServer\n\n# xcube imports\nfrom xcube.core.maskset import MaskSet\nfrom xcube.core.geom import mask_dataset_by_geometry\nfrom xcube.core.geom import clip_dataset_by_geometry\n\n#import xarray as xr \nimport matplotlib.pyplot as plt\nimport geopandas as gpd\nimport rasterio\n#import odc.geo.xr\n\n# Various utilities\nimport json\nfrom datetime import date, timedelta\nimport xarray as xr\nimport shapely.geometry\nimport IPython.display\nimport zarr\nimport numpy as np","key":"dHb5N2m66M"},{"type":"outputs","id":"5HKmP2hxDOW8FPxbRGk0b","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"nf32NDDPM7"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2022.10-14).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"tiJS0UCGHk"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}},"children":[],"key":"HjhyvHpUW4"}],"key":"eVmdQMKOSU"}],"key":"fxTJFoBRvo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Generation (Accessing PolarTEP data for analysis)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TxMViuYht9"}],"identifier":"data-generation-accessing-polartep-data-for-analysis","label":"Data Generation (Accessing PolarTEP data for analysis)","html_id":"data-generation-accessing-polartep-data-for-analysis","implicit":true,"key":"Ia5QeQWRZJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The first step in creating an application that analyzes data is to access data.  Using a data cube to generate an NDVI is inherhently a geospatial data analysis.  A study area or “bounding box” must first be defined.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MqyI5QmRPp"}],"key":"dN3EkkfZNq"}],"key":"V0FpAgjirW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#Creates bounding box, edit the coordinates to change the area\nx1 = -134.67 # degrees, westmost point\ny1 = 69.41  # degrees, southmost point\nx2 = -134.54  # degrees, eastmost point\ny2 = 69.50  # degrees, northmost point\n\nbbox = x1, y1, x2, y2","visibility":"show","key":"tvlw4MaHzs"},{"type":"outputs","id":"cGRvF45_QgGtOVAhoeNtb","children":[],"visibility":"show","key":"xFT5FX2UEi"}],"visibility":"show","key":"MghgEAol6n"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An IPython function can be used to visualize your study area (bounding box)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uxFhImDlF8"}],"key":"mmpHbW0Yze"}],"key":"td7P99Y6Jw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"IPython.display.GeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","key":"gU2Drg6gTv"},{"type":"outputs","id":"Gk7SX3PCTcuBJFlQXxLEW","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[-134.54,69.41],[-134.54,69.5],[-134.67,69.5],[-134.67,69.41],[-134.54,69.41]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}},"children":[],"key":"MlVZkGr8O3"}],"key":"M5PPEB4YFx"}],"key":"C2UkjQ74Yi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate Cube (create a multivariate data cube)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LooTXbfbzE"}],"identifier":"generate-cube-create-a-multivariate-data-cube","label":"Generate Cube (create a multivariate data cube)","html_id":"generate-cube-create-a-multivariate-data-cube","implicit":true,"key":"AgGuISQtOk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First create the configurations required for the cube. This includes the data bands and dates.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O5g0OPxpL1"}],"key":"ZPphRLjZmC"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"More information on S2L2A and other SH functionalities: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EXVHJk5DHj"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l2a/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​docs​.sentinel​-hub​.com​/api​/latest​/data​/sentinel​-2​-l2a/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WLc5rQwaIr"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l2a/","key":"XEiUL38Erz"}],"key":"fVzFlwEYyO"}],"key":"CJNFbbjqyY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spatial_res = 0.00018   # = 10.038 meters in degrees\n\ntime_range = ['2018-08-30','2018-09-30']\ncube_config = CubeConfig(dataset_name = 'S2L2A', #Calls the Sentinel-2 L2A library\n                         band_names = ['B02', 'B03', 'B04', 'B08'],\n                         tile_size = [512, 512],\n                         bbox = bbox,\n                         spatial_res = spatial_res,\n                         time_range = time_range,\n                         time_period = '5D') #S2L2A has a revisit time of 5 days, so anything shorter would be redundant","key":"S3z9OCqhDl"},{"type":"outputs","id":"dBeaawb4a7z9qHfpiIHtH","children":[],"key":"R1wrKk1x1j"}],"key":"v1LPQnNBh7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then create the cube. For computational efficiency the cube is created as a shell, and the data is called when required.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x6ioezwbaM"}],"key":"NFI9SkFNTN"}],"key":"cWS3Fu8cc3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"request_collector = Observers.request_collector() #Sends data to SH\n\n#Create the actual cube containing 'lazy' data\ncube = open_cube(cube_config, observer=request_collector)","key":"dUhzbE73qw"},{"type":"outputs","id":"Xa-_C0TUBtQ1pnlioWDbu","children":[],"key":"BP6wzCVDUZ"}],"key":"rivdfGDkkQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Display cube\ncube","key":"zccmVrDHUw"},{"type":"outputs","id":"liFnAM_qTfNHsEI9jlFSE","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"a46cf1550a3ddfd04be8a3254de931c2","path":"/polartep_notebooks/build/a46cf1550a3ddfd04be8a3254de931c2.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:    (time: 7, lat: 500, lon: 722, bnds: 2)\nCoordinates:\n  * lat        (lat) float64 69.5 69.5 69.5 69.5 ... 69.41 69.41 69.41 69.41\n  * lon        (lon) float64 -134.7 -134.7 -134.7 ... -134.5 -134.5 -134.5\n  * time       (time) datetime64[ns] 2018-09-01T12:00:00 ... 2018-10-01T12:00:00\n    time_bnds  (time, bnds) datetime64[ns] dask.array<chunksize=(7, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B02        (time, lat, lon) float32 dask.array<chunksize=(1, 500, 722), meta=np.ndarray>\n    B03        (time, lat, lon) float32 dask.array<chunksize=(1, 500, 722), meta=np.ndarray>\n    B04        (time, lat, lon) float32 dask.array<chunksize=(1, 500, 722), meta=np.ndarray>\n    B08        (time, lat, lon) float32 dask.array<chunksize=(1, 500, 722), meta=np.ndarray>\nAttributes: (12/13)\n    Conventions:               CF-1.7\n    title:                     S2L2A Data Cube Subset\n    history:                   [{'program': 'xcube_sh.chunkstore.SentinelHubC...\n    date_created:              2023-09-19T07:41:28.393438\n    time_coverage_start:       2018-08-30T00:00:00+00:00\n    time_coverage_end:         2018-10-04T00:00:00+00:00\n    ...                        ...\n    time_coverage_resolution:  P5DT0H0M0S\n    geospatial_lon_min:        -134.67\n    geospatial_lat_min:        69.41\n    geospatial_lon_max:        -134.54003999999998\n    geospatial_lat_max:        69.5\n    processing_level:          L2A","content_type":"text/plain"}}},"children":[],"key":"GIWWkqiIyq"}],"key":"oyI9r1DkDP"}],"key":"BQpIOH7P8e"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize data from the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nVdV7fcMch"}],"identifier":"visualize-data-from-the-cube","label":"Visualize data from the cube","html_id":"visualize-data-from-the-cube","implicit":true,"key":"YfzeKYGS7N"}],"key":"m8cdnbr6hQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Display RGB image of a single day\ncube[['B04', 'B03', 'B02']].isel(time=3).to_array().plot.imshow(robust=True, figsize=(10,10))","key":"IeE5lpTccf"},{"type":"outputs","id":"lXkAYOyib2LX5m12jkG1n","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81ebbddb39132d1d44bc7557361b6e2d","path":"/polartep_notebooks/build/81ebbddb39132d1d44bc7557361b6e2d.png"},"text/plain":{"content":"<Figure size 1000x1000 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"nmCQNntp4p"}],"key":"ymN2r0KDTO"}],"key":"JTlhHuvkgY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analyze data and generate new data (Normalized Difference Vegetation Index - NDVI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"emRVRhdZQF"}],"identifier":"analyze-data-and-generate-new-data-normalized-difference-vegetation-index-ndvi","label":"Analyze data and generate new data (Normalized Difference Vegetation Index - NDVI)","html_id":"analyze-data-and-generate-new-data-normalized-difference-vegetation-index-ndvi","implicit":true,"key":"aIbgDulGHO"}],"key":"GLysIxNiZ1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Create NDVI variable and add it into the cube\nndvi=(cube.B08-cube.B04)/(cube.B08+cube.B04)\n\nndvi.attrs['long_name'] = 'Normalized Difference Vegetation Index'\nndvi.attrs['units'] = 'unitless'\n\ncube['NDVI']=ndvi","key":"ElbuKCiPyx"},{"type":"outputs","id":"Ef02jmDIoY88OfTmThQRp","children":[],"key":"yVlNQpgdJ6"}],"key":"bhhKapyVp1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Displaying NDVI from a single day\ncube.NDVI.sel(time='2018-09-30', method='nearest').plot.imshow(vmin=-1, vmax=1, cmap='RdYlGn', figsize=(13, 10))","key":"hSS3pzFfv4"},{"type":"outputs","id":"uKK6hquL3GogRU0j-l6uR","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fef8ac8fd792b96182d260c8eb7b6195","path":"/polartep_notebooks/build/fef8ac8fd792b96182d260c8eb7b6195.png"},"text/plain":{"content":"<Figure size 1300x1000 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"IALm3XZfaZ"}],"key":"IDLoHIePBq"}],"key":"GQphWm8fYR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Creating ancillary data visualizations (graphs and charts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cMQrT2uY44"}],"identifier":"creating-ancillary-data-visualizations-graphs-and-charts","label":"Creating ancillary data visualizations (graphs and charts)","html_id":"creating-ancillary-data-visualizations-graphs-and-charts","implicit":true,"key":"ZjnytdYAza"}],"key":"afZ2E9H4yg"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"#Calculate the average using the x and y dimensions, so that it is done per day on the entire area\navg = cube.NDVI.mean(['lon', 'lat'])\n\n#Check to ensure the formatting is correct\nprint(avg)","key":"Ec1g2NBfDt"},{"type":"outputs","id":"kQYWdrF2Yk7AUQ2_dEMH7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'NDVI' (time: 7)>\ndask.array<mean_agg-aggregate, shape=(7,), dtype=float32, chunksize=(1,), chunktype=numpy.ndarray>\nCoordinates:\n  * time     (time) datetime64[ns] 2018-09-01T12:00:00 ... 2018-10-01T12:00:00\n"},"children":[],"key":"JitOYBoOVj"}],"key":"oYzpSCakLy"}],"key":"f9hGpQqLad"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"#Connect the NDVI value with the corrosponding date\ntimeseriesNDVI = avg.to_series()\n\n#Check to ensure the transpose occured correctly\nprint(timeseriesNDVI)","key":"Bb15ZydGFU"},{"type":"outputs","id":"bezUeOUnUIc_8GC2d7M_H","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"time\n2018-09-01 12:00:00    0.009137\n2018-09-06 12:00:00    0.029070\n2018-09-11 12:00:00    0.060464\n2018-09-16 12:00:00   -0.030509\n2018-09-21 12:00:00    0.016541\n2018-09-26 12:00:00   -0.026812\n2018-10-01 12:00:00   -0.022896\nName: NDVI, dtype: float32\n"},"children":[],"key":"MXuUc6OqLV"}],"key":"CLyQ417Vgj"}],"key":"WJxKzJtkDL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Simple plot to visualize the average NDVI change over time\nplt.plot(timeseriesNDVI)\nplt.xticks(rotation='vertical')\nplt.ylabel('NDVI')\nplt.show()","key":"mqatKgZ7UJ"},{"type":"outputs","id":"uo3V6hZQbDdXZXWV3IM2x","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a197036ea214ffdcfb3192d91f153b2c","path":"/polartep_notebooks/build/a197036ea214ffdcfb3192d91f153b2c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"zRp7XzsA3w"}],"key":"EBUmTxIVn2"}],"key":"bFPka0qv07"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.NDVI.plot.hist()\nplt.title('')\nplt.ylabel('Frequency')\nplt.xlabel('NDVI')\nplt.show()","key":"WChFhWOh84"},{"type":"outputs","id":"yrvSU5ZdXETO-nBv1_wpJ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"37b78b21a5f0c668f27e751b7e0ab337","path":"/polartep_notebooks/build/37b78b21a5f0c668f27e751b7e0ab337.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"qMvmBuxd6S"}],"key":"TpRHsNOK9F"}],"key":"ZOflGOnybB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Displaying all the dates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bd04039ilS"}],"identifier":"displaying-all-the-dates","label":"Displaying all the dates","html_id":"displaying-all-the-dates","implicit":true,"key":"svhsqUH87U"}],"key":"MdaJuaqVR1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.NDVI.plot.imshow(col='time', col_wrap=5, vmin=-1, vmax=1,cmap='RdYlGn')","key":"jKenro9DX1"},{"type":"outputs","id":"fKjAUoD_Y09Vir45b5ueU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7f51f21697c0>","content_type":"text/plain"}}},"children":[],"key":"Ofc8O1dgS1"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc354c644aba4af099e2f6f0a1a9e195","path":"/polartep_notebooks/build/fc354c644aba4af099e2f6f0a1a9e195.png"},"text/plain":{"content":"<Figure size 1600x600 with 11 Axes>","content_type":"text/plain"}}},"children":[],"key":"qoK62nJ6ig"}],"key":"lBZLkBj5Tz"}],"key":"sKfTqLNq07"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# SEEMS TO HAVE FIXED THE NAN ISSUE WHEN USING DIFFERENT DATA\n\nfor ndvi_date in cube.NDVI:\n    print(\n        {\n            \"date\": str(ndvi_date.time.values),\n            \"max\": ndvi_date.values.max(),\n            \"mean\": ndvi_date.values.mean(),\n            \"min\": ndvi_date.values.min(),\n            \"stDev\": np.std(ndvi_date.values),\n        }\n    )","key":"GaMORhDfd5"},{"type":"outputs","id":"BQUpjAO0cYhRC3PEs4WnZ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"{'date': '2018-09-01T12:00:00.000000000', 'max': 0.10448063, 'mean': 0.009137163, 'min': -0.06061923, 'stDev': 0.012537325}\n{'date': '2018-09-06T12:00:00.000000000', 'max': nan, 'mean': nan, 'min': nan, 'stDev': nan}\n{'date': '2018-09-11T12:00:00.000000000', 'max': 0.9901478, 'mean': 0.060464177, 'min': -0.9923077, 'stDev': 0.20669918}\n{'date': '2018-09-16T12:00:00.000000000', 'max': 0.99867284, 'mean': -0.030509043, 'min': -0.9957894, 'stDev': 0.5795754}\n{'date': '2018-09-21T12:00:00.000000000', 'max': 0.241729, 'mean': 0.016541189, 'min': -0.2819034, 'stDev': 0.030107213}\n{'date': '2018-09-26T12:00:00.000000000', 'max': 0.8571429, 'mean': -0.026812462, 'min': -0.99239546, 'stDev': 0.11204647}\n{'date': '2018-10-01T12:00:00.000000000', 'max': 0.98529416, 'mean': -0.022895835, 'min': -0.99479157, 'stDev': 0.25248358}\n"},"children":[],"key":"HMcjnzr3a6"}],"key":"OzHhE00P2M"}],"key":"ibo6z0tsT0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Discussion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xfBbFU5lpB"}],"identifier":"discussion","label":"Discussion","html_id":"discussion","implicit":true,"key":"pyb3vocwZN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Student discussion goes here.  Possibly using interactive learning and evaluation tools.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GIvzjjS6W6"}],"key":"tYyqaUDUPE"}],"key":"VDce3u0nOy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Export data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wyABRfaUoJ"}],"identifier":"export-data","label":"Export data","html_id":"export-data","implicit":true,"key":"e8Iw1NZEHc"}],"key":"YYjFZlwUyQ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\n\ndel cube.attrs['history']\ncube.to_netcdf(path=os.path.expanduser(\"~/test_data.nc\"), mode='w', format='NETCDF4')","visibility":"show","key":"GZe7zD1san"},{"type":"outputs","id":"LyQQ5cdvdod-IvHX235FE","children":[],"visibility":"show","key":"jBYVZpMv0x"}],"visibility":"show","key":"hzxkQGJwkT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Quiz","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pDPxRugxjA"}],"identifier":"quiz","label":"Quiz","html_id":"quiz","implicit":true,"key":"bzgptMHCS8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What are some limitations to the cube method?\n-- No cloud cover control, mosaicking is difficult and finicky, making it difficult to get the best possible image over a timeframe","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EW4DKFY2SG"}],"key":"evPAidN1MB"}],"key":"D6VSSoCJpV"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"What are some of the benefits?\n-- Simple and easy to understand and manipulate. Can easily write to netCDF and put into GIS as a multilayer raster if you want to create better maps","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YBvTKpEaJh"}],"key":"YHsuNBPBYH"}],"key":"Njyy4ZrWpQ"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Calculate NDWI instead of NDVI, or other calculations within the actual cube","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jzXahyPdZ9"}],"key":"OFTttvaUsT"}],"key":"FGWb4hOhIz"}],"key":"JCjFEsjbRE"}],"key":"YxHlyY1n3N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Related Research","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vyTxid61pN"}],"identifier":"related-research","label":"Related Research","html_id":"related-research","implicit":true,"key":"vQASevMgVW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Ashok, A., Rani, H. P., & Jayakumar, K. V. (2021). Monitoring of dynamic wetland changes using NDVI and NDWI based landsat imagery. Remote Sensing Applications: Society and Environment, 23, 100547.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DRJ3IF2mge"}],"key":"d8WIeUw3QK"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Oloyede, A. O., Olatunbosun, D. E., Asuquo, P. M., Udo, U. E., & Essien, I. O. (2021). Correlation Analysis of Vegetation and Land Surface Temperature in Uyo, Nigeria Using Satellite Remote Sensing and Python-Based Geographic Information System. Science and Technology Publishing, 5(2632-1017).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zBeiC9Fk2M"}],"key":"dhIk9uLx4x"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"...","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Gtux6xSk5B"}],"key":"U79KwlUQhB"}],"key":"uyDAchi82m"}],"key":"RaSpjefSLX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sentinel-3 Snow and ICE products (SICE)","url":"/notebooks/sice","group":"Notebooks"}}},"domain":"http://localhost:3000"}